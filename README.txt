####################################
##               ゆとシートⅡ     ##
##          by ゆとらいず工房     ##
##    https://yutorize.2-d.jp     ##
####################################

### 設置の手順 #######################################################################################
 1. config.cgi.defaultのファイル名をconfig.cgiに変更する（.defaultを消す）

 2. config.cgiを開いて、管理用パスなどを設定する

 3. ゆとシートのファイルをすべてサーバーにアップする

 4. index.cgiのパーミッション（属性）を<705>または<755>に変更する
   （サーバーによっては<700>などの可能性もアリ）

 5. ブラウザからシートのTOPページ(http://○○○/ytsheet2/sw2.5/（または/dx3rd/や/blp/）)へアクセスして
    問題なく表示されれば設置完了

### ファイル構成 #####################################################################################
  <>内は一般的なパーミッション設定です。基本的に、「index.cgi」以外は設定（変更）する必要はありません。
  ※index.cgiはシステムごとに1つあります

 /ytsheet2 <705> ディレクトリ（フォルダ）名は変更可
  |
  |- /_core <705> 本体部分格納ディレクトリ
  |  |
  |  |- /data <705> 共通登録データ（ユーザー情報）格納ディレクトリ
  |  |
  |  |- /lib  <705> 処理ファイル格納ディレクトリ
  |  |  |
  |  |  |- /ar2e  <705> BLP用処理ファイル格納ディレクトリ
  |  |  |- /blp   <705> BLP用処理ファイル格納ディレクトリ
  |  |  |- /dx3   <705> DX3rd用処理ファイル格納ディレクトリ
  |  |  |- /gs    <705> GS用処理ファイル格納ディレクトリ
  |  |  |- /kiz   <705> KIZ用処理ファイル格納ディレクトリ
  |  |  |- /sw2   <705> SW2.5用処理ファイル格納ディレクトリ
  |  |  |- /sw2.0 <705> AR2E用処理ファイル格納ディレクトリ
  |  |  |- /vc    <705> VC用処理ファイル格納ディレクトリ
  |  |     |- config-default.pl <604> デフォルト設定格納ファイル
  |  |     |- data-*****.pl     <604> シンドローム等データ等格納ファイル
  |  |     |- *****.pl          <604> その他処理ライブラリ
  |  |
  |  |- /skin <705> HTMLテンプレート＆CSS格納ディレクトリ
  |
  |- /ar2e  <705> AR2Eシートの入り口・データ格納ディレクトリ（名前変更可）
  |- /blp   <705> BLPシートの入り口・データ格納ディレクトリ（名前変更可）
  |- /dx3rd <705> DX3rdシートの入り口・データ格納ディレクトリ（名前変更可）
  |- /gs    <705> GSシートの入り口・データ格納ディレクトリ（名前変更可）
  |- /kiz   <705> KIZシートの入り口・データ格納ディレクトリ（名前変更可）
  |- /sw2.0 <705> SW2.0シートの入り口・データ格納ディレクトリ（名前変更可）
  |- /sw2.5 <705> SW2.5シートの入り口・データ格納ディレクトリ（名前変更可）
  |- /VC    <705> VCシートの入り口・データ格納ディレクトリ（名前変更可）
     |- /data              <705> 登録データ格納ディレクトリ
     |- index.cgi          <705> 入り口になるCGIファイル。パーミッション（属性）設定必須
     |- config.cgi.default <604> 設定ファイル。ファイル名を「必ず」 config.cgi に変更してください

### 運用解説 #########################################################################################
# 同システムで複数設置したい場合
 /ytsheet2
  |- /_core
  |- /sw2.5  ←このディレクトリをコピー＆名前変更して……
  |- /sw2.0
  |- /dx3rd
  |- /blp
                ↓  ↓  ↓
 /ytsheet2
  |- /_core
  |- /swA    ←swA～swCでそれぞれ別の設定で運用できる
  |- /swB    ←┘
  |- /swC    ←┘
  |- /sw2.0
  |- /dx3rd
  |- /blp

# 特定システムだけでいい時
 /ytsheet2
  |- /_core
  |- /sw2.5 
  |- /sw2.0
  |- /dx3rd  ←DX3rdだけでいい場合は……
  |- /blp
                ↓  ↓  ↓
 /ytsheet2
  |- /_core  ←_coreと、
  |- /dx3rd  ←dx3rdディレクトリ以外は削除してよい

### 更新履歴 #########################################################################################
# ver.1.22.0 - 2023-07-19 --------------------------------------------------
## 追加／変更
- ゴブリンスレイヤーTRPGに対応
- ゆとシート内リンクタグを「出力」メニューに追加
（魔物シート・アイテムシート・魔法シートのものも同様に出力メニュー内に移動）
- [SW2] 新種族・希少種に仮対応
- [SW2/アイテム] 武器防具データ欄の行増減・ソート
- [DX3] Sロイス用チェックボックス
- [DX3] シンドロームの自由記入

## 調整／改善
- ラジオボタンを再クリックで選択解除できるように
- datalist（入力候補）つきinput（入力欄）の表示域を拡大
（入力内容に被さる▼マークの為の表示域を狭くした上で、それをhover時のみにした）
- [SW2] 〈ガン〉のチャットパレットにおいて、特定の威力は用法に2Hが入力されていなければ出力しないようにした
- [DX3] メモリー欄の経験点計算を、チェックボックス式ではなく項目に値が入っているかで判断するようにした
- [DX3] ロイスの「関係」が「Dロイス」のとき、「状態」の項目を非表示にする
- [DX3] 編集画面ロード直後の処理負荷改善
- 他、レイアウト微調整など

## 不具合修正
以下の不具合の修正
- セリフプレビューにおいて、ルビと傍点が最初の1回しか置換されない
- Discordサーバーへの加入状況確認の不具合
- [SW2] 装飾品欄の2つ目の追加枠において、専用化のHPMP増加が計算されない
- [SW2] 【軍師の知略】未習得でも「先制力」に「ウォーリーダーLv＋知力B」が計算されてしまうことがある
- [SW2] テキスト形式での出力において、相域が記載されていない
- [SW2] 閲覧時、秘伝の括弧が重複している
- [SW2] 〈ガン〉のチャットパレットの数値ミス
- [SW2/アイテム] 能力分類マークの見出しと特定のテキスト装飾・整形との組み合わせの不具合
- [VC] アイテム欄でソートをおこなうと記入内容が保存されなくなる

# ver.1.21.0 - 2023-05-26 --------------------------------------------------
## 追加／変更
- キャラクター一覧にタグと最終参加セッションを表示 
- 検索項目に、マイリスト内検索のチェックボックス
- シート一覧のOGP
- 作成レギュレーションの備考欄
- 過去ログからの復元編集時、メモ欄・履歴欄に最新のデータを適用するボタン
- Tekey向けのチャットパレットを出力するオプション
- 閲覧側でカラーカスタムをOFFにするオプション
- スクロールの状態が一番上でない時、ヘッダをクリックするとページの一番上に戻す仕様
- ルビの含まれたテキストをコピーした際、ルビ部分を()で囲われるようにする仕様
- 各シートにおける、ヘッダ部分を固定
- 各種アイコンをFontAwesomeからGoogleMaterialSymbolsのものへ
- 一覧の性別アイコンをGoogleMaterialSymbolsのものへ
- シートの保存時において、Base64にエンコードして送信する、設置者向けのオプション（一部レンタルサーバーのWAF対策）
- [SW2.x] 秘伝魔法欄
- [SW2.x] 魔物シートの騎獣モード
- [SW2.x] 魔物シートの検索項目に「部位数」「知能」「知覚」「反応」「生息地」「弱点」
- [SW2.x] チャットパレットにおける、「ドルイド技能」「〈ガン〉」に対応した内容
- [SW2.x] 能力値作成履歴からシートを作成した場合に、採用した能力値作成履歴へのリンクをシートに記入する
- [SW2.5] 冒険者ランクで「始まりの剣★」以上を選択可能に
- [DX3] コンボの「条件」の入力補助機能
- [DX3] エフェクトの「制限」の入力候補に「従者専用」を追加
- [DX3] Ｄロイス「起源種」をもつキャラクターはコンボデータの条件を5行にする仕様
- [DX3] コンボを簡易的な形式で表示する機能

## 調整／改善
- details（テキスト折り畳み全般）の外観や挙動の微調整
- キャラクター画像のURL
- チャットパレットにおいて、ゆとチャ向けはダイスコードを行末尾に出力する
- モバイルブラウザにおける、PC版サイト閲覧モードのフォントサイズ自動調節を無効化
- モバイル閲覧時（特に編集画面）における、各項目の間隔（特に上下のmargin）を広げる
- [SW2][AR2E][VC] セッション履歴における、「取得総計」の行の見た目を目立たせる
- [SW2.x] 能力アイコンをシートのカラー設定に応じた色になるようにした
- [SW2.x] 信仰で「その他の信仰」を選んだ際の自由記入の内容を一覧データに反映するように
- [SW2.x] 技能の並びにおいて、魔法技能連続した並びにする
- [SW2.x] チャットパレットにおいて、「2d6」表記を「2d」表記に変更
- [SW2.5] 【陣率：軍師の知略】の補正を自動加算する
- [DX3][AR2E] 効果テキスト等の展開ボタンの外観をわかりやすく（目立つように）
- [DX3] 「ブリード」に有効な値がないとき、表示を空にする
- [DX3] 技能欄において、技能名もレベルも空なら、単位「Lv」を表示しない
- [AR2E] チャットパレットの変数において、「（能力値名）」と「（能力値名）判定」を分けた
- [KIZ] セッション履歴の「キャラクター作成」の行を削除

## 不具合修正
以下の不具合修正
- テキスト装飾の説明で、「透明」の項目が重複している（２つある）
- チャットパレットで、「全ての変数を出力する」オプションが（チェックの有無に関わらず）常にONだった
- キャラクター画像がない時にも（存在しない）画像へのアクセスが発生していた
- キャラクター名において、`:`があったり特定のテキスト装飾を用いるとレイアウトが崩れる
- JSONファイルからインポートしたとき、最初の編集画面でのみ画像が表示されてしまう
- テキスト装飾において、あいだに改行があってもルビ記法として解釈されてしまう
- [SW2.x] 魔物の特殊能力見出しにおいて、特定の文字装飾と組み合わせた場合、正常に処理されない
- [SW2.x] 能力アイコンの置換で`☐`が使えなかった（内部的に別の文字として扱われる`□`なら使えた）
- [SW2.x] チャットパレットにおいて、《命中強化》が反映されていない
- [SW2.x] ユドナリウムとココフォリアの駒出力において、複数部位モンスターが正常に出力されない
- [SW2.x] 魔物シート一覧において、ページネーションのリンク先が正常でない場合がある
- [SW2.x] 信仰欄において、“詐金神”メイガルが小神でなく大神になっていた
- [SW2.x] シートのテキスト出力において、バトルダンサー技能レベルが表示されない
- [SW2.x] ユドナリウムの駒出力において、バトルダンサー技能Lvが技能の項目でなくバフ・デバフの項目に追加されてしまう
- [SW2.x] 魔物知識・先制力の入力において、技能0レベルでも（非表示になって操作できない）修正欄に数値が入っていると、そのまま反映されてしまう
- [SW2.x] チャットパレット（BCDice向け）において、【ウルフバイト】の行が正しいレベルで出力されない
- [SW2.x] 魔物/アイテム/魔法シートにおいて、1行目に（テキスト装飾の）大見出しを入れても反映されず、また、2つ目以降の大見出しの見た目が合っていない
- [SW2.0] 戦闘特技《鎧貫き》が自動習得で表示されない
- [DX3] ソート後にコンボの自動計算が正常にはたらかない
- [DX3] 検索文字列に、特定の文字列を入力すると正常に動作しない
- [DX3] ロイス欄において、ソート後に感情のチェックを操作するとチェックの状態がズレてしまう
- [DX3] 習得エフェクト一覧において、末尾のエフェクトの下側に余計なボーダーが表示されることがある
- [DX3] モバイルでのシート編集時、ロイスの項目の見た目が正常でない
- [BLP] タグ検索が正常に動作していない
- [VC] クラス検索・スタイル検索が正常に動作していない
- [VC] セッション履歴の「取得総計」の値が表示されていない

## 内部的な影響のみの修正
- 閲覧時の画像表示の処理を共通化
- セッション履歴周りのCSSを共通化
- タグ置換（テキスト装飾）の処理を共通化


# ver.1.20.0 - 2022-11-12 --------------------------------------------------
## 追加／変更
- [SW2.x] バトルダンサー技能に対応
- [SW2.x] 秘伝蘭と流派シートをバトルマスタリー仕様へ
- [DX3] エフェクトの「制限」欄の入力候補にアージエフェクト用のものを追加
- [DX3] エフェクトの「侵蝕値」に入力候補を提示する
- [DX3] チャットパレットにココフォリアやユドナリウムリリィ用の侵蝕率操作コマンドを追加
- 
## 不具合修正／調整／改善
- 過去ログの命名ボタンの表記を変更
- シート保存時、編集保護設定を変更した際に設定とディレクトリがズレることがある不具合を修正
- コメントアウト記法（ `//...` ）を使用したときに改行が残らないように修正
- [SW2.x] BCDice更新の影響でユドナリウムのコマ出力のダイスボットの指定が空になる不具合の修正
- [SW2.x] BCDiceの、半減での威力算出後にダメージを追加するのチャットパレットに対応
- [SW2.x] 威力表のC値の書式を[]を使ったものに統一
- [DX3] 初期レギュレーションの経験点を変更しても総計に即時範囲されない不具合の修正
- [DX3] ヴィークルと一般アイテムが行ソートで行き来できた不具合を修正
- [DX3] 能力値の成長がない場合、表示画面の「経験点計算」の「能力値」が空欄になるのを修正
- [BLP] 閲覧時、隷印の内容が正しく表示されない不具合の修正
- [BLP] Perlのバージョンによってエラーが出る問題を修正

## 内部的な影響のみの修正
- アカウント未紐づけのシートの保存先ディレクトリを変更
- [SW2.x] 戦士系技能の処理を共通化
- [SW2.x] チャットパレットの技能周りの処理を変更


# ver.1.19.0 - 2022-09-16 --------------------------------------------------
- ヴィジョンコネクトに対応
- ゆとシートの見た目を維持したHTML形式のシートをダウンロードする機能
- HTMLやJSON、コマ用データなどを含んだ全部入りZipをダウンロードする機能
- json出力にゆとチャ用のプロパティ追加
- 編集時のチャットパレットプリセットがBCDice向けのものに変更されない不具合を修正
- FireFoxでの編集画面において、名前にルビを振るとヘッダの名前下部が若干見切れる問題を修正
- 閲覧権限がない場合、jsonの取得やシートの複製ができないように修正
- コマ作成時、パラメータが反映されない場合がある不具合を修正
- 一部項目に文字装飾を行っていると、OGP用のタグからレイアウト崩れが起きていたのを修正（OGP用概要テキストからタグを削除する処理を追加）
- チャットパレットにおいて、機能しないダイスコマンドが出る事がある不具合を修正
- 画像の圧縮処理が正常に行われないことがある不具合を修正
- [SW2.x] 魔物シートのチャットパレットプリセットを全体的に改善
- [SW2.x] 魔法リストのカテゴリの項で、区切り文字が出ないことがある不具合を修正
- [SW2.x] レベル検索で、以下（<=x）や以上（=>x）の検索が出来なくなっていた（SW2.x）
- [SW2.5] 言語欄などで入力が長いとレイアウトが若干崩れる不具合を修正
- [SW2.0] 一部戦闘特技と賦術の習得レベルや記述ミス（2.5のものになっていたの）を修正
- [SW2.0] 編集画面で総名誉点が減算されてしまう不具合を修正
- [DX3rd][AR2E] エフェクト欄やスキル欄等のゴミ箱エリアのデフォルト表示のテキストを修正
- [DX3rd] チャットパレットに一部技能が出ない不具合を修正
- 他、一部処理などを整理

# ver.1.18.0 - 2022-08-04 --------------------------------------------------
- カラーカスタムの色見本
- カラーカスタムONのチェックボックスを削除して直接カラー変更する仕様に変更
- カラーカスタムを「デフォルトに戻す」ボタンを追加
- 保存時に画面遷移しない仕様に変更
- 編集画面のメニューを改修
- [SW2.x] 魔法・神格・流派シート
- [SW2.x] アイテムシートも「出力」の項目追加（JSON形式のみ）
- [SW2.x] アイテムシートもOGP対応
- [SW2.x] 魔物シート・アイテムシートにカラーカスタム機能追加
- [SW2.x] 練技や呪歌等の欄に「自由記入」の選択肢を追加
- [BLP] 能力値の自動計算対応
- [BLP] 血僕用の項目欄追加
- レイアウト調整多数
- 他、不具合修正・機能調整多数

# ver.1.17.0 - 2022-06-17 --------------------------------------------------
- キズナバレットに対応
- JSONファイルからのコンバート追加
- 過去ログに名前をつける機能追加
- [BLP] 傷号特技用の欄を追加
- [BLP] 練度ソート
- [BLP] パートナーのカラーカスタム反映
- [AR2E] レガシークラス追加
- 背景画像の軽量化
- 他、不具合修正・機能調整多数
- レイアウト調整多数

# ver.1.16.0 - 2022-01-17 --------------------------------------------------
- アリアンロッドRPG2Eに対応
- キャラクター画像のWebP形式対応と自動形式変換・圧縮を追加
- 画像プレビューのドラッグ・ホイール操作追加
- 一部桁数が多い数値を用いる欄において3桁カンマ区切り表示＆カンマ区切り入力でも自動計算する仕様追加
- [DX3rd] 能力値が0の時のエラー表示追加
- [SW2.5] 妖精魔法の使用可能ランク表示追加
- [SW2.5] チャットパレットのプリセットの深智魔法対応
- 他、不具合修正多数
- レイアウト等微調整

# ver.1.15.0 - 2021-10-23 --------------------------------------------------
- [SW2.5] メイガスアーツ対応
- [SW2.x] 編集画面の技能一覧を種類別にソート
- [SW2.x] 履歴欄下部に各項目合計値表示
- 他、不具合修正多数
- レイアウト等微調整

# ver.1.14.0 - 2021-08-14 --------------------------------------------------
- [SW2.5] アウトロープロファイルブック対応
- [SW2.0] 蛮族名誉点と盟竜点
- ココフォリアのクリップボードAPI対応
- 「保存」ボタンを「出力」ボタンへ変更
- 他、不具合修正多数

# ver.1.13.0 - 2021-06-18 --------------------------------------------------
- [DX3rd] クロウリングケイオス対応
- [DX3rd] エフェクト欄にドラッグ＆ドロップで削除できるエリア追加
- [SW2.0] 超越帯の対応強化
- 名前・二つ名・コードネーム欄の仕様変更（ルビ用の欄を追加）
- 他、不具合修正多数
- レイアウト等微調整

# ver.1.12.0 - 2021-03-10 --------------------------------------------------
- ソードワールド2.0に対応
- 人鬼血盟RPGブラッドパスに対応
- 閲覧制限機能を強化（段階的な閲覧制限を追加）
- チャットパレットの調整
- レイアウト調整（特にモバイル閲覧時）
- [SW2.x] 言語欄の機能強化（セージ・バード技能による習得をカウントする仕様に）
- 他、不具合修正多数

# ver.1.11.0 - 2020-12-23 --------------------------------------------------
- キャラクターシートの保存機能追加
- 過去ログ（バックアップ）からの復元編集機能追加
- チャットパレットのデフォルト出力内容変更
- [SW2.5] 防具欄の仕様変更
- [SW2.5] 一般技能にソート機能追加
- [SW2.5] 魔物データ・アイテムデータのコンバート機能追加（ゆとシートⅡ間のみ）
- [DX3rd] 能力値内訳、エフェクト経験点修正を表示するよう修正
- 他、不具合修正多数
- レイアウト等微調整


# ver.1.10.2 - 2020-11-08 --------------------------------------------------
- [SW2.5] 言語欄のに入力候補追加
- [SW2.5] 装備の必筋が上限を超える場合に表示変更
- 他、不具合修正多数

# ver.1.10.1 - 2020-10-28 --------------------------------------------------
- [DX3rd] コンボ欄のソート不具合修正

# ver.1.10.0 - 2020-10-22 --------------------------------------------------
- [SW2.5] モンストラスロア対応
- [DX3rd] コンボ欄の技能補正自動挿入追加
- PL名検索追加

# ver.1.09.0 - 2020-06-17 --------------------------------------------------
- テキスト整形ルールに折り畳み追加
- 画像トリミング項目の改良
- [SW2.5] 魔力欄の改良
- [DX3rd] 一部表示・計算不具合
- [DX3rd] チャットパレット出力をゆとチャ向けとBCDice向けの二種に分割
- [DX3rd] コンバート時の不具合修正・変換調整
- チャットパレット出力を改良
- 他、軽微な修正
- レイアウト等微調整

# ver.1.08.2 - 2020-05-03 --------------------------------------------------
- [DX3rd] エフェクト説明の開閉機能追加
- [DX3rd] 保管所からのコンバート不具合数点修正
- [DX3rd] エフェクトの攻撃力と基準値が入れ替わる不具合修正
- 他、軽微な修正
- レイアウト等微調整

# ver.1.08.1 - 2020-04-09 --------------------------------------------------
- 全般: 経験点欄の表示を変更
- [DX3rd] ゆとシートⅠ⇒Ⅱにおけるコンバート不具合数点修正

# ver.1.08.0 - 2020-04-07 --------------------------------------------------
- ダブルクロスThe 3rd Editionに対応、名前を「ゆとシートⅡ」に変更（for SW2.5を削除）
- ディレクトリ構造を変更
- レイアウト等調整
- 一部項目にドラッグ＆ドロップによるソート機能追加
- コンバート機能追加
- キャラクターシートにOGP設定追加

# ver.1.07.0 - 2020-03-21 --------------------------------------------------
- キャラクターシートのカラーカスタム機能追加
- フェローに第二行動欄追加
- 適用フォントの修正・変更
- チャットパレットの編集結果をプリセットに上書きするか追加するか選択できる項目追加
- チャットパレットのプリセットで変数を使わないものを選択できる項目を追加
- OAuth認証機能追加（by @Shunshun94）
- Template.pm内蔵
- ソースコードの整理

# ver.1.06.0 - 2019-10-19 --------------------------------------------------
- 割り振り作成のポイント算出に2.5式(ET)を追加
- 装飾品欄の追加枠が再編集時に表示されていない不具合修正
- 登録数が多い場合、リストの処理が遅かったのを改善
- 賦術などにも専用化補正のチェックを追加
- 武器欄に「ガン（物理）」のカテゴリ追加（バヨネット等向け）
- ナイトモードの処理を変更
- ナイトモードの状態でページを移動した際のチラつきを低減

# ver.1.05.0 - 2019-05-23 --------------------------------------------------
- マテリアルカード欄追加
- パッケージ・魔物知識・先制に修正値欄追加
- キャラクター画像の表示形式を編集画面でも反映
- チャットパレット用の変数を自動出力
- 幅広用のレイアウト追加
- 武器欄の入れ替え機能追加
- チャットパレットの編集欄を追加

# ver.1.04.0 - 2019-02-24 --------------------------------------------------
- 2.0要素対応（各冒険者技能、一般技能欄、秘伝欄追加）
- 検索機能強化（名前・種族・経験点・技能・信仰）
- 戦闘特技の自動置き換えをオフに
- 置き換え条件を満たした特技を強調表示
- 習得条件を満たさない特技を強調表示
- 一部ファイル名変更
- ノーブルエルフとマナフレアが作成できない不具合修正
- 細かなバグ修正

# ver.1.03.0 - 2019-01-21 --------------------------------------------------
- アイテム登録機能追加
- 武器アイコン追加
- 閲覧禁止機能追加
- 不名誉欄追加
- ルールブックⅢ対応
- 細かなバグ修正 ／ レイアウト調整

# ver.1.02.0 - 2018-10-18 --------------------------------------------------
- ルールブックⅡ対応
- ＰＣ能力値作成機能追加
- 割り振り作成機能追加
- キャラクターリストのソート（名前／PL／Lv／経験点／更新日時）追加
- 細かなバグ修正 ／ レイアウト調整

# ver.1.01.0 - 2018-09-13 --------------------------------------------------
- 魔物データ管理機能追加
- キャラクターデータ格納ディレクトリを data から data/chara へ変更
- 細かなバグ修正 ／ レイアウト調整

# ver.1.00.0 - 2018-09-03 --------------------------------------------------
- リリース


### SPECIAL THANKS ###################################################################################
# json出力 および OAuth認証ログイン制作
# ＆ コンバート機能参考
- しゅんしゅんひよこ (@Shunshun94) さん
